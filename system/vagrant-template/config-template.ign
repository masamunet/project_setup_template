{"ignition":{"config":{},"security":{"tls":{}},"timeouts":{},"version":"2.2.0"},"networkd":{},"passwd":{},"storage":{"files":[{"filesystem":"root","path":"/home/core/.bashrc","contents":{"source":"data:,export%20TZ%3DJST-9%0Aalias%20dc%3D%22docker-compose%22%0Aalias%20dcup%3D%22docker-compose%20up%20-d%22%0Aalias%20dcrun%3D%22docker-compose%20run%22%0Aalias%20dcexec%3D%22docker-compose%20exec%20--rm%22%0Acd%20%2Fhome%2Fcore%2Fdocker%0A","verification":{}},"mode":420},{"filesystem":"root","path":"/opt/bin/dc_watch.sh","contents":{"source":"data:,%23!%2Fbin%2Fbash%0Awhile%20%5B%20!%20-e%20%2Fopt%2Fbin%2Fdocker-compose%20-o%20!%20-e%20%2Fhome%2Fcore%2Fdocker%20-o%20!%20-e%20%2Fhome%2Fcore%2Fdevelopment%20-o%20!%20-e%20%2Fhome%2Fcore%2Flibs%2Fwp_themes%20-o%20!%20-e%20%2Fhome%2Fcore%2Fstorages%2Fmysql%20%5D%3B%20do%20wait%3B%20sleep%201%3B%20done%0A%0Adeclare%20-i%20i%3D0%0Awhile%20%5B%5B%20%24i%20-lt%2010%20%5D%5D%0Ado%0A%20%20sleep%201%0A%20%20i%3D%24((i%2B1))%0Adone%0A%0A%2Fusr%2Fbin%2Fchmod%20%2Bw%20%2Fhome%2Fcore%2Flibs%2Fwp_themes%0A%2Fusr%2Fbin%2Fchmod%20-R%20%2Bw%20%2Fhome%2Fcore%2Fstorages%0A%2Fopt%2Fbin%2Fdocker-compose%20-f%20%2Fhome%2Fcore%2Fdocker%2Fdocker-compose.yml%20up%20-d%0A","verification":{}},"mode":493}]},"systemd":{"units":[{"enable":true,"name":"docker.service"},{"enable":true,"name":"timezone.service"},{"contents":"[Unit]\nDescription=Create swapfile\nConditionPathExists=!/swapfile\nAfter=install-docker-compose.service\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nTimeoutStartSec=0\n\nExecStart=/usr/bin/sh -c \"/usr/bin/dd if=/dev/zero of=/swapfile bs=1M count=1024\"\nExecStart=/usr/bin/sh -c \"/usr/sbin/mkswap /swapfile\"\nExecStart=/usr/bin/sh -c \"/usr/sbin/swapon /swapfile\"\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"swap-memory-create.service"},{"contents":"[Unit]\nDescription=Turn on swap\nAfter=swap-memory-create.service\nRequires=swap-memory-create.service\nConditionPathExists=/swapfile\n\n[Service]\nType=oneshot\nEnvironment=\"SWAPFILE=/swapfile\"\nRemainAfterExit=true\nExecStartPre=/usr/sbin/losetup -f ${SWAPFILE}\nExecStart=/usr/bin/sh -c \"/usr/sbin/swapon $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1)\"\nExecStop=/usr/bin/sh -c \"/usr/sbin/swapoff $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1)\"\nExecStopPost=/usr/bin/sh -c \"/usr/sbin/losetup -d $(/usr/sbin/losetup -j ${SWAPFILE} | /usr/bin/cut -d : -f 1)\"\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"swap-memory.service"},{"contents":"[Unit]\nDescription=Install docker-compose\nConditionPathExists=!/opt/bin/docker-compose\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nTimeoutStartSec=0\n\nEnvironment=SYSTEMD_LOG_LEVEL=debug\nExecStart=/usr/bin/mkdir -p /opt/bin/\nExecStart=/usr/bin/curl -o /opt/bin/docker-compose -sL \"https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-linux-x86_64\"\nExecStart=/usr/bin/chmod +x /opt/bin/docker-compose\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"install-docker-compose.service"},{"contents":"[Unit]\nDescription=Watch docker mount directory\nAfter=install-docker-compose.service\nRequires=install-docker-compose.service\n\n[Service]\nType=simple\nUser=core\n\nExecStart=/opt/bin/dc_watch.sh\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"dc-watch.service"}]}}