{"ignition":{"config":{},"security":{"tls":{}},"timeouts":{},"version":"2.2.0"},"networkd":{},"passwd":{},"storage":{"files":[{"filesystem":"root","path":"/home/core/.bashrc","contents":{"source":"data:,alias%20dc%3D%22docker-compose%22%0Aalias%20dcup%3D%22docker-compose%20up%20-d%22%0Aalias%20dcrun%3D%22docker-compose%20run%22%0Aalias%20dcexec%3D%22docker-compose%20exec%20--rm%22%0Acd%20%2Fhome%2Fcore%2Fdocker%0A","verification":{}},"mode":420},{"filesystem":"root","path":"/opt/bin/dc_watch.sh","contents":{"source":"data:,%23!%2Fbin%2Fbash%0Awhile%20%5B%20!%20-e%20%2Fopt%2Fbin%2Fdocker-compose%20-o%20!%20-e%20%2Fhome%2Fcore%2Fdocker%20-o%20!%20-e%20%2Fhome%2Fcore%2Fdevelopment%20-o%20!%20-e%20%2Fhome%2Fcore%2Flibs%2Fwp_themes%20%20-o%20!%20-e%20%2Fhome%2Fcore%2Flibs%2Fwp_plugins%20%5D%3B%20do%20wait%3B%20sleep%201%3B%20done%0Asystemctl%20start%20up-docker-compose.service%0A","verification":{}},"mode":493}]},"systemd":{"units":[{"enable":true,"name":"docker.service"},{"enable":true,"name":"timezone.service"},{"contents":"[Unit]\nDescription=Install docker-compose\nConditionPathExists=!/opt/bin/docker-compose\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nTimeoutStartSec=0\n\nEnvironment=COMPOSE_VERSION=\"1.14.0\"\nExecStart=/usr/bin/mkdir -p /opt/bin/\nExecStart=/usr/bin/curl -o /opt/bin/docker-compose -sL \"https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-linux-x86_64\"\nExecStart=/usr/bin/chmod +x /opt/bin/docker-compose\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"install-docker-compose.service"},{"contents":"[Unit]\nDescription=Up docker-compose\nAfter=install-docker-compose.service network.target docker.service\nRequires=install-docker-compose.service\nConditionPathExists=/home/core/docker/\n\n[Service]\nType=simple\nUser=core\nRestart=always\nWorkingDirectory=/home/core/docker\n\n# Remove old containers, images and volumes\n# ExecStartPre=/opt/bin/docker-compose -f /home/core/docker/docker-compose.yml down -v\n# ExecStartPre=/opt/bin/docker-compose -f /home/core/docker/docker-compose.yml rm -v\n# ExecStartPre=-/bin/bash -c 'docker volume rm $(docker volume ls -q)'\n# ExecStartPre=-/bin/bash -c 'docker rmi $(docker images | grep \"\u003cnone\u003e\" | awk \\'{print $3}\\')'\n# ExecStartPre=-/bin/bash -c 'docker rm -v $(docker ps -aq)'\n\n# Compose up\nExecStart=/opt/bin/docker-compose -f /home/core/docker/docker-compose.yml up -d\n\n# Compose down, remove containers and volumes\n# ExecStop=/opt/bin/docker-compose -f /home/core/docker/docker-compose.yml down -v\nExecStop=/opt/bin/docker-compose -f /home/core/docker/docker-compose.yml down\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"up-docker-compose.service"},{"contents":"[Unit]\nDescription=Watch docker mount directory\nAfter=install-docker-compose.service up-docker-compose.service\nRequires=install-docker-compose.service up-docker-compose.service\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nTimeoutStartSec=0\n\nExecStart=/opt/bin/dc_watch.sh\n\n[Install]\nWantedBy=multi-user.target\n","enable":true,"name":"dc-watch.service"}]}}